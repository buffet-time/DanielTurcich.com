import{d as B,r as f,l as _,A as M,o as i,c as u,a as e,u as C,b as w,t as T,w as k,v as q,h as U,m as j,F,B as O,f as E,e as z,s as I}from"./index-DzlCaQhd.js";import{c as V,D as P,C as R,a as L}from"./shared-Dh9W48qA.js";const H={class:"tw-card bg-[#424242] p-4 w-4/5"},J=["d"],K={class:"flex flex-col"},Q={class:"m-0 p-4"},W={key:0},X={key:1},Y={class:"h-6"},Z={class:"flex justify-center"},ee=2**(1/12),te=440,ne=B({__name:"SoundGenerator",props:{generator:{}},emits:["deleteGenerator"],setup(N){const l=f(.07),t=f(440),d=f("sine"),b=f("A"),n=f(4),r=f(0),c=f(!1);let s,o,g,y=!1,x=0,m=9;const D=["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"];N.generator.generatorType==="Frequency"&&_(t,()=>{y||h(),o.frequency.setValueAtTime(t.value,s.currentTime)}),_(r,(v,a)=>{y||h(),x=v-a,G(),x>0?$("Up"):(x=Math.abs(x),$("Down"))}),_(l,()=>{y||h(),c.value?(o.disconnect(),g.gain.setValueAtTime(l.value,s.currentTime),o.connect(g).connect(s.destination)):g.gain.setValueAtTime(l.value,s.currentTime)}),_(d,()=>{y||h(),c.value?(o.disconnect(),o.type=d.value,o.connect(g).connect(s.destination)):o.type=d.value}),M(()=>{o?.disconnect()});function S(){c.value=!c.value,y||h(),c.value?o.connect(g).connect(s.destination):o.disconnect()}function A(v){return parseFloat((v*2*100).toFixed(1))}function h(){s=new AudioContext,g=new GainNode(s,{gain:l.value}),o=new OscillatorNode(s,{type:d.value,frequency:t.value}),o.start(),o.connect(s.destination),o.disconnect(),y=!0}function $(v){do v==="Up"?m===11?(n.value++,m=0):m++:m===0?(n.value--,m=11):m--,b.value=D[m],x--;while(x>0)}function G(){t.value=parseFloat((te*ee**r.value).toFixed(4)),o.frequency.setValueAtTime(t.value,s.currentTime)}return(v,a)=>(i(),u("div",H,[(i(),u("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:a[0]||(a[0]=p=>v.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:C(V)},null,8,J)])),e("div",K,[e("div",Q,[v.generator.generatorType==="Frequency"?(i(),u("div",W,[w(" Frequency: "+T(t.value)+" ",1),k(e("input",{id:"range-1","onUpdate:modelValue":a[1]||(a[1]=p=>t.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[q,t.value]])])):v.generator.generatorType==="Note"?(i(),u("div",X,[e("div",Y,[w(" Note/ Frequency: "+T(b.value)+" ",1),e("sub",null,T(n.value),1),w(" / "+T(t.value),1)]),k(e("input",{id:"range-1","onUpdate:modelValue":a[2]||(a[2]=p=>r.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[q,r.value]])])):U("",!0),e("div",null,[w(" Volume: "+T(A(l.value))+"% ",1),k(e("input",{"onUpdate:modelValue":a[3]||(a[3]=p=>l.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[q,l.value]])]),k(e("select",{"onUpdate:modelValue":a[4]||(a[4]=p=>d.value=p),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},a[5]||(a[5]=[e("option",{value:"sawtooth"},"Sawtooth",-1),e("option",{selected:"",value:"sine"},"Sine",-1),e("option",{value:"square"},"Square",-1),e("option",{value:"triangle"},"Triangle",-1)]),512),[[j,d.value]])]),e("div",Z,[e("button",{class:"tw-button",onClick:S},[c.value?(i(),u(F,{key:0},[w("Stop")],64)):(i(),u(F,{key:1},[w("Start")],64))])])])]))}}),oe={class:"tw-flex-col-center"},le={class:"flex justify-center"},ae=["d"],se={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},re={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},ie=["d"],ue={class:"p-4 flex gap-2 justify-center"},ve=B({__name:"Frequency",setup(N){const l=O([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),t=f();E(async()=>{if(!t.value){console.error("Release Modal does not exist: ",t.value);return}await P([t.value]),R(t.value)});function d(b){l.push({id:l.length>0?l[l.length-1].id+1:0,generatorType:b}),t.value?.close()}return(b,n)=>(i(),u(F,null,[e("div",oe,[n[4]||(n[4]=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1)),(i(!0),u(F,null,z(l,(r,c)=>(i(),I(ne,{key:r.id,index:c,generator:r,onDeleteGenerator:s=>l.splice(c,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",le,[(i(),u("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:n[0]||(n[0]=r=>t.value?.showModal())},[e("path",{d:C(L)},null,8,ae)]))])]),e("dialog",{ref_key:"generatorModal",ref:t,class:"bg-transparent"},[e("div",se,[e("div",re,[n[5]||(n[5]=e("h5",null,"Add a new generator",-1)),(i(),u("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:n[1]||(n[1]=r=>t.value?.close())},[e("path",{fill:"currentColor",d:C(V)},null,8,ie)]))]),e("div",ue,[e("button",{class:"tw-button",onClick:n[2]||(n[2]=r=>d("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:n[3]||(n[3]=r=>d("Note"))},"Note")])])],512)],64))}});export{ve as default};
//# sourceMappingURL=Frequency-Cs3w9jUp.js.map
