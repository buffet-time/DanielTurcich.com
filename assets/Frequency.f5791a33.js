import{d as B,r as f,j as q,B as O,o as i,c,a as e,u as D,e as w,t as k,w as C,v as $,g as E,m as z,F,C as I,k as P,b as R,q as L}from"./index.47f635d3.js";import{c as V,D as H,C as J,a as K}from"./shared.e7e049c1.js";const Q={class:"tw-card bg-[#424242] p-4 w-4/5"},W=["d"],X={class:"flex flex-col"},Y={class:"m-0 p-4"},Z={key:0},ee={key:1},te={class:"h-6"},ne=e("option",{value:"sawtooth"},"Sawtooth",-1),oe=e("option",{selected:"",value:"sine"},"Sine",-1),se=e("option",{value:"square"},"Square",-1),le=e("option",{value:"triangle"},"Triangle",-1),ae=[ne,oe,se,le],re={class:"flex justify-center"},ie=w("Stop"),ue=w("Start"),ce=B({__name:"SoundGenerator",props:{generator:null},emits:["deleteGenerator"],setup(T){const v=T,n=f(.07),l=f(440),d=f("sine"),o=f("A"),u=f(4),s=f(0),g=f(!1);let r,t,_,x=!1,h=0,m=9;const S=2**(1/12),G=440,A=["C","D\u266D","D","E\u266D","E","F","G\u266D","G","A\u266D","A","B\u266D","B"];v.generator.generatorType==="Frequency"&&q(l,()=>{x||b(),t.frequency.setValueAtTime(l.value,r.currentTime)}),q(s,(y,a)=>{x||b(),h=y-a,j(),h>0?N("Up"):(h=Math.abs(h),N("Down"))}),q(n,()=>{x||b(),g.value?(t.disconnect(),_.gain.setValueAtTime(n.value,r.currentTime),t.connect(_).connect(r.destination)):_.gain.setValueAtTime(n.value,r.currentTime)}),q(d,()=>{x||b(),g.value?(t.disconnect(),t.type=d.value,t.connect(_).connect(r.destination)):t.type=d.value}),O(()=>{t==null||t.disconnect()});function M(){g.value=!g.value,x||b(),g.value?t.connect(_).connect(r.destination):t.disconnect()}function U(y){return parseFloat((y*2*100).toFixed(1))}function b(){r=new AudioContext,_=new GainNode(r,{gain:n.value}),t=new OscillatorNode(r,{type:d.value,frequency:l.value}),t.start(),t.connect(r.destination),t.disconnect(),x=!0}function N(y){do y==="Up"?m===11?(u.value++,m=0):m++:m===0?(u.value--,m=11):m--,o.value=A[m],h--;while(h>0)}function j(){l.value=parseFloat((G*S**s.value).toFixed(4)),t.frequency.setValueAtTime(l.value,r.currentTime)}return(y,a)=>(i(),c("div",Q,[(i(),c("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:a[0]||(a[0]=p=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:D(V)},null,8,W)])),e("div",X,[e("div",Y,[T.generator.generatorType==="Frequency"?(i(),c("div",Z,[w(" Frequency: "+k(l.value)+" ",1),C(e("input",{id:"range-1","onUpdate:modelValue":a[1]||(a[1]=p=>l.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,l.value]])])):T.generator.generatorType==="Note"?(i(),c("div",ee,[e("div",te,[w(" Note/ Frequency: "+k(o.value)+" ",1),e("sub",null,k(u.value),1),w(" / "+k(l.value),1)]),C(e("input",{id:"range-1","onUpdate:modelValue":a[2]||(a[2]=p=>s.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,s.value]])])):E("",!0),e("div",null,[w(" Volume: "+k(U(n.value))+"% ",1),C(e("input",{"onUpdate:modelValue":a[3]||(a[3]=p=>n.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,n.value]])]),C(e("select",{"onUpdate:modelValue":a[4]||(a[4]=p=>d.value=p),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},ae,512),[[z,d.value]])]),e("div",re,[e("button",{class:"tw-button",onClick:M},[g.value?(i(),c(F,{key:0},[ie],64)):(i(),c(F,{key:1},[ue],64))])])])]))}}),de={class:"tw-flex-col-center"},ve=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),pe={class:"flex justify-center"},fe=["d"],ge={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},me={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},ye=e("h5",null,"Add a new generator",-1),_e=["d"],xe={class:"p-4 flex gap-2 justify-center"},be=B({__name:"Frequency",setup(T){const v=I([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),n=f();P(async()=>{if(!n.value){console.error("Release Modal does not exist: ",n.value);return}await H([n.value]),J(n.value)});function l(d){var o;v.push({id:v.length>0?v[v.length-1].id+1:0,generatorType:d}),(o=n.value)==null||o.close()}return(d,o)=>(i(),c(F,null,[e("div",de,[ve,(i(!0),c(F,null,R(v,(u,s)=>(i(),L(ce,{key:u.id,index:s,generator:u,onDeleteGenerator:g=>v.splice(s,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",pe,[(i(),c("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:o[0]||(o[0]=u=>{var s;return(s=n.value)==null?void 0:s.showModal()})},[e("path",{d:D(K)},null,8,fe)]))])]),e("dialog",{ref_key:"generatorModal",ref:n,class:"bg-transparent"},[e("div",ge,[e("div",me,[ye,(i(),c("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:o[1]||(o[1]=u=>{var s;return(s=n.value)==null?void 0:s.close()})},[e("path",{fill:"currentColor",d:D(V)},null,8,_e)]))]),e("div",xe,[e("button",{class:"tw-button",onClick:o[2]||(o[2]=u=>l("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:o[3]||(o[3]=u=>l("Note"))},"Note")])])],512)],64))}});export{be as default};
