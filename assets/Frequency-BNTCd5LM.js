import{d as V,r as d,l as T,A as U,o as r,c as u,a as e,u as A,b as f,t as x,w as q,v as C,h as M,m as _,F as k,B as j,f as E,e as O,s as R}from"./index-gN_Ubj-p.js";import{c as B,D as $,C as z,a as H}from"./shared-BvGcyLlD.js";let I={class:"tw-card bg-[#424242] p-4 w-4/5"},J=["d"],K={class:"flex flex-col"},L={class:"m-0 p-4"},P={key:0},Q={key:1},W={class:"h-6"},X={class:"flex justify-center"},Y=2**(1/12),Z=V({__name:"SoundGenerator",props:{generator:{}},emits:["deleteGenerator"],setup(G){let l,t,i,s=d(.07),n=d(440),o=d("sine"),b=d("A"),h=d(4),F=d(0),g=d(!1),m=!1,y=0,v=9,D=["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"];function S(){g.value=!g.value,m||w(),g.value?t.connect(i).connect(l.destination):t.disconnect()}function w(){i=new GainNode(l=new AudioContext,{gain:s.value}),(t=new OscillatorNode(l,{type:o.value,frequency:n.value})).start(),t.connect(l.destination),t.disconnect(),m=!0}function N(p){do p==="Up"?v===11?(h.value++,v=0):v++:v===0?(h.value--,v=11):v--,b.value=D[v],y--;while(y>0)}return G.generator.generatorType==="Frequency"&&T(n,()=>{m||w(),t.frequency.setValueAtTime(n.value,l.currentTime)}),T(F,(p,a)=>{m||w(),y=p-a,n.value=Number.parseFloat((440*Y**F.value).toFixed(4)),t.frequency.setValueAtTime(n.value,l.currentTime),y>0?N("Up"):(y=Math.abs(y),N("Down"))}),T(s,()=>{m||w(),g.value?(t.disconnect(),i.gain.setValueAtTime(s.value,l.currentTime),t.connect(i).connect(l.destination)):i.gain.setValueAtTime(s.value,l.currentTime)}),T(o,()=>{m||w(),g.value?(t.disconnect(),t.type=o.value,t.connect(i).connect(l.destination)):t.type=o.value}),U(()=>{t?.disconnect()}),(p,a)=>(r(),u("div",I,[(r(),u("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:a[0]||(a[0]=c=>p.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:A(B)},null,8,J)])),e("div",K,[e("div",L,[p.generator.generatorType==="Frequency"?(r(),u("div",P,[f(" Frequency: "+x(n.value)+" ",1),q(e("input",{id:"range-1","onUpdate:modelValue":a[1]||(a[1]=c=>n.value=c),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[C,n.value]])])):p.generator.generatorType==="Note"?(r(),u("div",Q,[e("div",W,[f(" Note/ Frequency: "+x(b.value)+" ",1),e("sub",null,x(h.value),1),f(" / "+x(n.value),1)]),q(e("input",{id:"range-1","onUpdate:modelValue":a[2]||(a[2]=c=>F.value=c),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[C,F.value]])])):M("",!0),e("div",null,[f(" Volume: "+x(Number.parseFloat((200*s.value).toFixed(1)))+"% ",1),q(e("input",{"onUpdate:modelValue":a[3]||(a[3]=c=>s.value=c),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[C,s.value]])]),q(e("select",{"onUpdate:modelValue":a[4]||(a[4]=c=>o.value=c),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},a[5]||(a[5]=[e("option",{value:"sawtooth"},"Sawtooth",-1),e("option",{selected:"",value:"sine"},"Sine",-1),e("option",{value:"square"},"Square",-1),e("option",{value:"triangle"},"Triangle",-1)]),512),[[_,o.value]])]),e("div",X,[e("button",{class:"tw-button",onClick:S},[g.value?(r(),u(k,{key:0},[f("Stop")],64)):(r(),u(k,{key:1},[f("Start")],64))])])])]))}}),ee={class:"tw-flex-col-center"},te={class:"flex justify-center"},ne=["d"],le={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},ae={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},oe=["d"],re={class:"p-4 flex gap-2 justify-center"},ie=V({__name:"Frequency",setup(G){let l=j([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),t=d();function i(s){l.push({id:l.length>0?l[l.length-1].id+1:0,generatorType:s}),t.value?.close()}return E(async()=>{if(!t.value){console.error("Release Modal does not exist: ",t.value);return}await $([t.value]),z(t.value)}),(s,n)=>(r(),u(k,null,[e("div",ee,[n[4]||(n[4]=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1)),(r(!0),u(k,null,O(l,(o,b)=>(r(),R(Z,{key:o.id,index:b,generator:o,onDeleteGenerator:h=>l.splice(b,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",te,[(r(),u("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:n[0]||(n[0]=o=>t.value?.showModal())},[e("path",{d:A(H)},null,8,ne)]))])]),e("dialog",{ref_key:"generatorModal",ref:t,class:"bg-transparent"},[e("div",le,[e("div",ae,[n[5]||(n[5]=e("h5",null,"Add a new generator",-1)),(r(),u("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:n[1]||(n[1]=o=>t.value?.close())},[e("path",{fill:"currentColor",d:A(B)},null,8,oe)]))]),e("div",re,[e("button",{class:"tw-button",onClick:n[2]||(n[2]=o=>i("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:n[3]||(n[3]=o=>i("Note"))},"Note")])])],512)],64))}});export{ie as default};
