import{d as B,r as f,k,B as M,o as i,c as u,a as e,u as F,e as x,t as b,w as T,v as C,h as U,m as j,F as q,C as O,f as E,b as z,q as I}from"./index-LifHkACd.js";import{c as V,D as P,C as R,a as L}from"./shared-UQEP7bSl.js";const H={class:"tw-card bg-[#424242] p-4 w-4/5"},J=["d"],K={class:"flex flex-col"},Q={class:"m-0 p-4"},W={key:0},X={key:1},Y={class:"h-6"},Z=e("option",{value:"sawtooth"},"Sawtooth",-1),ee=e("option",{selected:"",value:"sine"},"Sine",-1),te=e("option",{value:"square"},"Square",-1),ne=e("option",{value:"triangle"},"Triangle",-1),oe=[Z,ee,te,ne],se={class:"flex justify-center"},le=2**(1/12),ae=440,re=B({__name:"SoundGenerator",props:{generator:{}},emits:["deleteGenerator"],setup($){const o=f(.07),t=f(440),c=f("sine"),h=f("A"),s=f(4),r=f(0),d=f(!1);let l,n,g,y=!1,_=0,m=9;const D=["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"];$.generator.generatorType==="Frequency"&&k(t,()=>{y||w(),n.frequency.setValueAtTime(t.value,l.currentTime)}),k(r,(v,a)=>{y||w(),_=v-a,A(),_>0?N("Up"):(_=Math.abs(_),N("Down"))}),k(o,()=>{y||w(),d.value?(n.disconnect(),g.gain.setValueAtTime(o.value,l.currentTime),n.connect(g).connect(l.destination)):g.gain.setValueAtTime(o.value,l.currentTime)}),k(c,()=>{y||w(),d.value?(n.disconnect(),n.type=c.value,n.connect(g).connect(l.destination)):n.type=c.value}),M(()=>{n?.disconnect()});function S(){d.value=!d.value,y||w(),d.value?n.connect(g).connect(l.destination):n.disconnect()}function G(v){return parseFloat((v*2*100).toFixed(1))}function w(){l=new AudioContext,g=new GainNode(l,{gain:o.value}),n=new OscillatorNode(l,{type:c.value,frequency:t.value}),n.start(),n.connect(l.destination),n.disconnect(),y=!0}function N(v){do v==="Up"?m===11?(s.value++,m=0):m++:m===0?(s.value--,m=11):m--,h.value=D[m],_--;while(_>0)}function A(){t.value=parseFloat((ae*le**r.value).toFixed(4)),n.frequency.setValueAtTime(t.value,l.currentTime)}return(v,a)=>(i(),u("div",H,[(i(),u("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:a[0]||(a[0]=p=>v.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:F(V)},null,8,J)])),e("div",K,[e("div",Q,[v.generator.generatorType==="Frequency"?(i(),u("div",W,[x(" Frequency: "+b(t.value)+" ",1),T(e("input",{id:"range-1","onUpdate:modelValue":a[1]||(a[1]=p=>t.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[C,t.value]])])):v.generator.generatorType==="Note"?(i(),u("div",X,[e("div",Y,[x(" Note/ Frequency: "+b(h.value)+" ",1),e("sub",null,b(s.value),1),x(" / "+b(t.value),1)]),T(e("input",{id:"range-1","onUpdate:modelValue":a[2]||(a[2]=p=>r.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[C,r.value]])])):U("",!0),e("div",null,[x(" Volume: "+b(G(o.value))+"% ",1),T(e("input",{"onUpdate:modelValue":a[3]||(a[3]=p=>o.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[C,o.value]])]),T(e("select",{"onUpdate:modelValue":a[4]||(a[4]=p=>c.value=p),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},oe,512),[[j,c.value]])]),e("div",se,[e("button",{class:"tw-button",onClick:S},[d.value?(i(),u(q,{key:0},[x("Stop")],64)):(i(),u(q,{key:1},[x("Start")],64))])])])]))}}),ie={class:"tw-flex-col-center"},ue=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),ce={class:"flex justify-center"},de=["d"],ve={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},pe={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},fe=e("h5",null,"Add a new generator",-1),me=["d"],ge={class:"p-4 flex gap-2 justify-center"},xe=B({__name:"Frequency",setup($){const o=O([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),t=f();E(async()=>{if(!t.value){console.error("Release Modal does not exist: ",t.value);return}await P([t.value]),R(t.value)});function c(h){o.push({id:o.length>0?o[o.length-1].id+1:0,generatorType:h}),t.value?.close()}return(h,s)=>(i(),u(q,null,[e("div",ie,[ue,(i(!0),u(q,null,z(o,(r,d)=>(i(),I(re,{key:r.id,index:d,generator:r,onDeleteGenerator:l=>o.splice(d,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",ce,[(i(),u("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:s[0]||(s[0]=r=>t.value?.showModal())},[e("path",{d:F(L)},null,8,de)]))])]),e("dialog",{ref_key:"generatorModal",ref:t,class:"bg-transparent"},[e("div",ve,[e("div",pe,[fe,(i(),u("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:s[1]||(s[1]=r=>t.value?.close())},[e("path",{fill:"currentColor",d:F(V)},null,8,me)]))]),e("div",ge,[e("button",{class:"tw-button",onClick:s[2]||(s[2]=r=>c("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:s[3]||(s[3]=r=>c("Note"))},"Note")])])],512)],64))}});export{xe as default};
//# sourceMappingURL=Frequency-0M3MOEpo.js.map
