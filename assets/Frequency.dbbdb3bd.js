import{d as B,r as f,j as C,B as O,o as i,c as d,a as e,u as T,e as w,t as k,w as D,v as $,g as E,p as R,C as z,F,D as I,k as P,b as L,q as H}from"./index.1e5d0f89.js";import{c as V,D as J,C as K,a as Q}from"./shared.c9cf924d.js";const W={class:"tw-card bg-[#424242] p-4 w-4/5"},X=["d"],Y={class:"flex flex-col"},Z={class:"m-0 p-4"},ee={key:0},te={key:1},ne={class:"h-6"},oe=e("option",{value:"sawtooth"},"Sawtooth",-1),se=e("option",{selected:"",value:"sine"},"Sine",-1),le=e("option",{value:"square"},"Square",-1),ae=e("option",{value:"triangle"},"Triangle",-1),re=[oe,se,le,ae],ie={class:"flex justify-center"},ue=w("Stop"),ce=w("Start"),de=B({__name:"SoundGenerator",props:{generator:null},emits:["deleteGenerator"],setup(q){const v=q,n=f(.07),l=f(440),u=f("sine"),o=f("A"),c=f(4),s=f(0),g=f(!1);let r,t,_,x=!1,h=0,m=9;const S=2**(1/12),G=440,A=["C","D\u266D","D","E\u266D","E","F","G\u266D","G","A\u266D","A","B\u266D","B"];v.generator.generatorType==="Frequency"?C(l,()=>{x||b(),t.frequency.setValueAtTime(l.value,r.currentTime)}):C(s,(y,a)=>{x||b(),h=y-a,j(),h>0?N("Up"):(h=Math.abs(h),N("Down"))}),C(n,()=>{x||b(),g.value?(t.disconnect(),_.gain.setValueAtTime(n.value,r.currentTime),t.connect(_).connect(r.destination)):_.gain.setValueAtTime(n.value,r.currentTime)}),C(u,()=>{x||b(),g.value?(t.disconnect(),t.type=u.value,t.connect(_).connect(r.destination)):t.type=u.value}),O(()=>{t==null||t.disconnect()});function M(){g.value=!g.value,x||b(),g.value?t.connect(_).connect(r.destination):t.disconnect()}function U(y){return parseFloat((y*2*100).toFixed(1))}function b(){r=new AudioContext,_=new GainNode(r,{gain:n.value}),t=new OscillatorNode(r,{type:u.value,frequency:l.value}),t.start(),t.connect(r.destination),t.disconnect(),x=!0}function N(y){do y==="Up"?m===11?(c.value++,m=0):m++:m===0?(c.value--,m=11):m--,o.value=A[m],h--;while(h>0)}function j(){l.value=parseFloat((G*S**s.value).toFixed(4)),t.frequency.setValueAtTime(l.value,r.currentTime)}return(y,a)=>(i(),d("div",W,[(i(),d("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:a[0]||(a[0]=p=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:T(V)},null,8,X)])),e("div",Y,[e("div",Z,[q.generator.generatorType==="Frequency"?(i(),d("div",ee,[w(" Frequency: "+k(l.value)+" ",1),D(e("input",{id:"range-1","onUpdate:modelValue":a[1]||(a[1]=p=>l.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,l.value]])])):q.generator.generatorType==="Note"?(i(),d("div",te,[e("div",ne,[w(" Note/ Frequency: "+k(T(o))+" ",1),e("sub",null,k(c.value),1),w(" / "+k(l.value),1)]),D(e("input",{id:"range-1","onUpdate:modelValue":a[2]||(a[2]=p=>s.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,s.value]])])):E("",!0),e("div",null,[w(" Volume: "+k(U(n.value))+"% ",1),D(e("input",{"onUpdate:modelValue":a[3]||(a[3]=p=>n.value=p),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,n.value]])]),D(e("select",{"onUpdate:modelValue":a[4]||(a[4]=p=>z(u)?u.value=p:null),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},re,512),[[R,T(u)]])]),e("div",ie,[e("button",{class:"tw-button",onClick:M},[g.value?(i(),d(F,{key:0},[ue],64)):(i(),d(F,{key:1},[ce],64))])])])]))}}),ve={class:"tw-flex-col-center"},pe=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),fe={class:"flex justify-center"},ge=["d"],me={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},ye={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},_e=e("h5",null,"Add a new generator",-1),xe=["d"],he={class:"p-4 flex gap-2 justify-center"},ke=B({__name:"Frequency",setup(q){const v=I([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),n=f();P(async()=>{if(!n.value){console.error("Release Modal does not exist: ",n.value);return}await J([n.value]),K(n.value)});function l(u){var o;v.push({id:v.length>0?v[v.length-1].id+1:0,generatorType:u}),(o=n.value)==null||o.close()}return(u,o)=>(i(),d(F,null,[e("div",ve,[pe,(i(!0),d(F,null,L(v,(c,s)=>(i(),H(de,{key:c.id,index:s,generator:c,onDeleteGenerator:g=>v.splice(s,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",fe,[(i(),d("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:o[0]||(o[0]=c=>{var s;return(s=n.value)==null?void 0:s.showModal()})},[e("path",{d:T(Q)},null,8,ge)]))])]),e("dialog",{ref_key:"generatorModal",ref:n,class:"bg-transparent"},[e("div",me,[e("div",ye,[_e,(i(),d("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:o[1]||(o[1]=c=>{var s;return(s=n.value)==null?void 0:s.close()})},[e("path",{fill:"currentColor",d:T(V)},null,8,xe)]))]),e("div",he,[e("button",{class:"tw-button",onClick:o[2]||(o[2]=c=>l("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:o[3]||(o[3]=c=>l("Note"))},"Note")])])],512)],64))}});export{ke as default};
