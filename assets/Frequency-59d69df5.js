import{d as V,r as p,k as q,B as O,o as r,c as u,a as e,u as N,e as w,t as k,w as C,v as $,h as E,m as z,F,C as I,f as P,b as R,q as L}from"./index-4c070e4e.js";import{c as D,D as H,C as J,a as K}from"./shared-a8eb8048.js";const Q={class:"tw-card bg-[#424242] p-4 w-4/5"},W=["d"],X={class:"flex flex-col"},Y={class:"m-0 p-4"},Z={key:0},ee={key:1},te={class:"h-6"},ne=e("option",{value:"sawtooth"},"Sawtooth",-1),oe=e("option",{selected:"",value:"sine"},"Sine",-1),se=e("option",{value:"square"},"Square",-1),le=e("option",{value:"triangle"},"Triangle",-1),ae=[ne,oe,se,le],re={class:"flex justify-center"},ie=V({__name:"SoundGenerator",props:{generator:null},emits:["deleteGenerator"],setup(T){const d=T,t=p(.07),o=p(440),c=p("sine"),l=p("A"),i=p(4),f=p(0),m=p(!1);let a,n,_,x=!1,h=0,g=9;const S=2**(1/12),G=440,A=["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"];d.generator.generatorType==="Frequency"&&q(o,()=>{x||b(),n.frequency.setValueAtTime(o.value,a.currentTime)}),q(f,(y,s)=>{x||b(),h=y-s,j(),h>0?B("Up"):(h=Math.abs(h),B("Down"))}),q(t,()=>{x||b(),m.value?(n.disconnect(),_.gain.setValueAtTime(t.value,a.currentTime),n.connect(_).connect(a.destination)):_.gain.setValueAtTime(t.value,a.currentTime)}),q(c,()=>{x||b(),m.value?(n.disconnect(),n.type=c.value,n.connect(_).connect(a.destination)):n.type=c.value}),O(()=>{n?.disconnect()});function M(){m.value=!m.value,x||b(),m.value?n.connect(_).connect(a.destination):n.disconnect()}function U(y){return parseFloat((y*2*100).toFixed(1))}function b(){a=new AudioContext,_=new GainNode(a,{gain:t.value}),n=new OscillatorNode(a,{type:c.value,frequency:o.value}),n.start(),n.connect(a.destination),n.disconnect(),x=!0}function B(y){do y==="Up"?g===11?(i.value++,g=0):g++:g===0?(i.value--,g=11):g--,l.value=A[g],h--;while(h>0)}function j(){o.value=parseFloat((G*S**f.value).toFixed(4)),n.frequency.setValueAtTime(o.value,a.currentTime)}return(y,s)=>(r(),u("div",Q,[(r(),u("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:s[0]||(s[0]=v=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:N(D)},null,8,W)])),e("div",X,[e("div",Y,[T.generator.generatorType==="Frequency"?(r(),u("div",Z,[w(" Frequency: "+k(o.value)+" ",1),C(e("input",{id:"range-1","onUpdate:modelValue":s[1]||(s[1]=v=>o.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,o.value]])])):T.generator.generatorType==="Note"?(r(),u("div",ee,[e("div",te,[w(" Note/ Frequency: "+k(l.value)+" ",1),e("sub",null,k(i.value),1),w(" / "+k(o.value),1)]),C(e("input",{id:"range-1","onUpdate:modelValue":s[2]||(s[2]=v=>f.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,f.value]])])):E("",!0),e("div",null,[w(" Volume: "+k(U(t.value))+"% ",1),C(e("input",{"onUpdate:modelValue":s[3]||(s[3]=v=>t.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,t.value]])]),C(e("select",{"onUpdate:modelValue":s[4]||(s[4]=v=>c.value=v),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},ae,512),[[z,c.value]])]),e("div",re,[e("button",{class:"tw-button",onClick:M},[m.value?(r(),u(F,{key:0},[w("Stop")],64)):(r(),u(F,{key:1},[w("Start")],64))])])])]))}}),ue={class:"tw-flex-col-center"},ce=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),de={class:"flex justify-center"},ve=["d"],pe={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},fe={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},me=e("h5",null,"Add a new generator",-1),ge=["d"],ye={class:"p-4 flex gap-2 justify-center"},he=V({__name:"Frequency",setup(T){const d=I([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]),t=p();P(async()=>{if(!t.value){console.error("Release Modal does not exist: ",t.value);return}await H([t.value]),J(t.value)});function o(c){d.push({id:d.length>0?d[d.length-1].id+1:0,generatorType:c}),t.value?.close()}return(c,l)=>(r(),u(F,null,[e("div",ue,[ce,(r(!0),u(F,null,R(d,(i,f)=>(r(),L(ie,{key:i.id,index:f,generator:i,onDeleteGenerator:m=>d.splice(f,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",de,[(r(),u("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:l[0]||(l[0]=i=>t.value?.showModal())},[e("path",{d:N(K)},null,8,ve)]))])]),e("dialog",{ref_key:"generatorModal",ref:t,class:"bg-transparent"},[e("div",pe,[e("div",fe,[me,(r(),u("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:l[1]||(l[1]=i=>t.value?.close())},[e("path",{fill:"currentColor",d:N(D)},null,8,ge)]))]),e("div",ye,[e("button",{class:"tw-button",onClick:l[2]||(l[2]=i=>o("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:l[3]||(l[3]=i=>o("Note"))},"Note")])])],512)],64))}});export{he as default};
