import{d as B,r as p,j as F,A as E,o as a,c as r,a as e,u as _,e as b,t as T,w as C,v as $,g as L,p as O,B as P,F as N,C as z,k as R,b as H,q as I}from"./index.dbf78331.js";import{c as V,d as J,a as K}from"./dialog-polyfill.esm.c4f433fc.js";const Q={class:"tw-card bg-[#424242] p-4 w-4/5"},W=["d"],X={class:"flex flex-col"},Y={class:"m-0 p-4"},Z={key:0},ee={key:1},te={class:"h-6"},ne=e("option",{value:"sawtooth"},"Sawtooth",-1),oe=e("option",{selected:"",value:"sine"},"Sine",-1),se=e("option",{value:"square"},"Square",-1),le=e("option",{value:"triangle"},"Triangle",-1),ae=[ne,oe,se,le],ie={class:"flex justify-center"},re=b("Stop"),ue=b("Start"),ce=B({props:{generator:null},emits:["deleteGenerator"],setup(q){const d=q,i=p(.07),o=p(440),u=p("sine"),h=p("A"),x=p(4),f=p(0),l=p(!1);let n,t,c,g=!1,w=0,m=9;const M=2**(1/12),S=440,A=["C","D\u266D","D","E\u266D","E","F","G\u266D","G","A\u266D","A","B\u266D","B"];d.generator.generatorType==="Frequency"?F(o,()=>{g||k(),t.frequency.setValueAtTime(o.value,n.currentTime)}):F(f,(y,s)=>{g||k(),w=y-s,j(),w>0?D("Up"):(w=Math.abs(w),D("Down"))}),F(i,()=>{g||k(),l.value?(t.disconnect(),c.gain.setValueAtTime(i.value,n.currentTime),t.connect(c).connect(n.destination)):c.gain.setValueAtTime(i.value,n.currentTime)}),F(u,()=>{g||k(),l.value?(t.disconnect(),t.type=u.value,t.connect(c).connect(n.destination)):t.type=u.value}),E(()=>{t==null||t.disconnect()});function G(){l.value=!l.value,g||k(),l.value?t.connect(c).connect(n.destination):t.disconnect()}function U(y){return parseFloat((y*2*100).toFixed(1))}function k(){n=new AudioContext,c=new GainNode(n,{gain:i.value}),t=new OscillatorNode(n,{type:u.value,frequency:o.value}),t.start(),t.connect(n.destination),t.disconnect(),g=!0}function D(y){do y==="Up"?m===11?(x.value++,m=0):m++:m===0?(x.value--,m=11):m--,h.value=A[m],w--;while(w>0)}function j(){o.value=parseFloat((S*M**f.value).toFixed(4)),t.frequency.setValueAtTime(o.value,n.currentTime)}return(y,s)=>(a(),r("div",Q,[(a(),r("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:s[0]||(s[0]=v=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:_(V)},null,8,W)])),e("div",X,[e("div",Y,[q.generator.generatorType==="Frequency"?(a(),r("div",Z,[b(" Frequency: "+T(o.value)+" ",1),C(e("input",{id:"range-1","onUpdate:modelValue":s[1]||(s[1]=v=>o.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,o.value]])])):q.generator.generatorType==="Note"?(a(),r("div",ee,[e("div",te,[b(" Note/ Frequency: "+T(_(h))+" ",1),e("sub",null,T(x.value),1),b(" / "+T(o.value),1)]),C(e("input",{id:"range-1","onUpdate:modelValue":s[2]||(s[2]=v=>f.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,f.value]])])):L("",!0),e("div",null,[b(" Volume: "+T(U(i.value))+"% ",1),C(e("input",{"onUpdate:modelValue":s[3]||(s[3]=v=>i.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,i.value]])]),C(e("select",{"onUpdate:modelValue":s[4]||(s[4]=v=>P(u)?u.value=v:null),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},ae,512),[[O,_(u)]])]),e("div",ie,[e("button",{class:"tw-button",onClick:G},[l.value?(a(),r(N,{key:0},[re],64)):(a(),r(N,{key:1},[ue],64))])])])]))}}),de={class:"tw-flex-col-center"},ve=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),pe={class:"flex justify-center"},fe=["d"],ge={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},me={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},ye=e("h5",null,"Add a new generator",-1),_e=["d"],he={class:"p-4 flex gap-2 justify-center"},be=B({setup(q){const d=z([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]);let i;const o=p();R(()=>{J.registerDialog(o.value),i=document.querySelector("#generatorModal")});function u(){o.value.showModal(),setTimeout(()=>{document.addEventListener("click",x)},0)}function h(){document.removeEventListener("click",x),o.value.close()}function x(l){l.composedPath().includes(i)||h()}function f(l){d.push({id:d.length>0?d[d.length-1].id+1:0,generatorType:l}),h()}return(l,n)=>(a(),r(N,null,[e("div",de,[ve,(a(!0),r(N,null,H(_(d),(t,c)=>(a(),I(ce,{key:t.id,index:c,generator:t,onDeleteGenerator:g=>_(d).splice(c,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",pe,[(a(),r("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:u},[e("path",{d:_(K)},null,8,fe)]))])]),e("dialog",{ref_key:"generatorModal",ref:o,class:"bg-transparent"},[e("div",ge,[e("div",me,[ye,(a(),r("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:h},[e("path",{fill:"currentColor",d:_(V)},null,8,_e)]))]),e("div",he,[e("button",{class:"tw-button",onClick:n[0]||(n[0]=t=>f("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:n[1]||(n[1]=t=>f("Note"))},"Note")])])],512)],64))}});export{be as default};
