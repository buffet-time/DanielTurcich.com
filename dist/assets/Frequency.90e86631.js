import{d as B,r as p,j as F,A as E,o as a,c as i,a as e,u as T,e as w,t as k,w as C,v as $,g as L,p as O,B as P,F as N,C as z,k as R,b as H,q as I}from"./index.98846005.js";import{c as S,d as J,a as K}from"./dialog-polyfill.esm.c4f433fc.js";const Q={class:"tw-card bg-[#424242] p-4 w-4/5"},W=["d"],X={class:"flex flex-col"},Y={class:"m-0 p-4"},Z={key:0},ee={key:1},te={class:"h-6"},ne=e("option",{value:"sawtooth"},"Sawtooth",-1),oe=e("option",{selected:"",value:"sine"},"Sine",-1),se=e("option",{value:"square"},"Square",-1),le=e("option",{value:"triangle"},"Triangle",-1),ae=[ne,oe,se,le],re={class:"flex justify-center"},ie=w("Stop"),ue=w("Start"),ce=B({name:"SoundGenerator",props:{generator:null},emits:["deleteGenerator"],setup(q){const d=q,r=p(.07),o=p(440),u=p("sine"),_=p("A"),h=p(4),f=p(0),l=p(!1);let n,t,c,g=!1,x=0,m=9;const V=2**(1/12),M=440,A=["C","D\u266D","D","E\u266D","E","F","G\u266D","G","A\u266D","A","B\u266D","B"];d.generator.generatorType==="Frequency"?F(o,()=>{g||b(),t.frequency.setValueAtTime(o.value,n.currentTime)}):F(f,(y,s)=>{g||b(),x=y-s,j(),x>0?D("Up"):(x=Math.abs(x),D("Down"))}),F(r,()=>{g||b(),l.value?(t.disconnect(),c.gain.setValueAtTime(r.value,n.currentTime),t.connect(c).connect(n.destination)):c.gain.setValueAtTime(r.value,n.currentTime)}),F(u,()=>{g||b(),l.value?(t.disconnect(),t.type=u.value,t.connect(c).connect(n.destination)):t.type=u.value}),E(()=>{t==null||t.disconnect()});function G(){l.value=!l.value,g||b(),l.value?t.connect(c).connect(n.destination):t.disconnect()}function U(y){return parseFloat((y*2*100).toFixed(1))}function b(){n=new AudioContext,c=new GainNode(n,{gain:r.value}),t=new OscillatorNode(n,{type:u.value,frequency:o.value}),t.start(),t.connect(n.destination),t.disconnect(),g=!0}function D(y){do y==="Up"?m===11?(h.value++,m=0):m++:m===0?(h.value--,m=11):m--,_.value=A[m],x--;while(x>0)}function j(){o.value=parseFloat((M*V**f.value).toFixed(4)),t.frequency.setValueAtTime(o.value,n.currentTime)}return(y,s)=>(a(),i("div",Q,[(a(),i("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:s[0]||(s[0]=v=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:T(S)},null,8,W)])),e("div",X,[e("div",Y,[q.generator.generatorType==="Frequency"?(a(),i("div",Z,[w(" Frequency: "+k(o.value)+" ",1),C(e("input",{id:"range-1","onUpdate:modelValue":s[1]||(s[1]=v=>o.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,o.value]])])):q.generator.generatorType==="Note"?(a(),i("div",ee,[e("div",te,[w(" Note/ Frequency: "+k(T(_))+" ",1),e("sub",null,k(h.value),1),w(" / "+k(o.value),1)]),C(e("input",{id:"range-1","onUpdate:modelValue":s[2]||(s[2]=v=>f.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,f.value]])])):L("",!0),e("div",null,[w(" Volume: "+k(U(r.value))+"% ",1),C(e("input",{"onUpdate:modelValue":s[3]||(s[3]=v=>r.value=v),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,r.value]])]),C(e("select",{"onUpdate:modelValue":s[4]||(s[4]=v=>P(u)?u.value=v:null),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},ae,512),[[O,T(u)]])]),e("div",re,[e("button",{class:"tw-button",onClick:G},[l.value?(a(),i(N,{key:0},[ie],64)):(a(),i(N,{key:1},[ue],64))])])])]))}}),de={class:"tw-flex-col-center"},ve=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),pe={class:"flex justify-center"},fe=["d"],ge={id:"generatorModal",class:"text-neutral-300 bg-[#383838] w-72"},me={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},ye=e("h5",null,"Add a new generator",-1),_e=["d"],he={class:"p-4 flex gap-2 justify-center"},be=B({name:"Frequency",setup(q){const d=z([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]);let r;const o=p();R(()=>{J.registerDialog(o.value),r=document.querySelector("#generatorModal")});function u(){o.value.showModal(),setTimeout(()=>{document.addEventListener("click",h)},0)}function _(){document.removeEventListener("click",h),o.value.close()}function h(l){l.composedPath().includes(r)||_()}function f(l){d.push({id:d.length>0?d[d.length-1].id+1:0,generatorType:l}),_()}return(l,n)=>(a(),i(N,null,[e("div",de,[ve,(a(!0),i(N,null,H(d,(t,c)=>(a(),I(ce,{key:t.id,index:c,generator:t,onDeleteGenerator:g=>d.splice(c,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",pe,[(a(),i("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-neutral-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:u},[e("path",{d:T(K)},null,8,fe)]))])]),e("dialog",{ref_key:"generatorModal",ref:o,class:"bg-transparent"},[e("div",ge,[e("div",me,[ye,(a(),i("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:_},[e("path",{fill:"currentColor",d:T(S)},null,8,_e)]))]),e("div",he,[e("button",{class:"tw-button",onClick:n[0]||(n[0]=t=>f("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:n[1]||(n[1]=t=>f("Note"))},"Note")])])],512)],64))}});export{be as default};
