import{d as V,r as v,y as q,C as E,b as a,e as r,f as e,u as b,t as k,w as F,n as $,m as C,s as z,z as L,D as O,F as N,E as P,o as R,g as H,A as I}from"./vendor.4e48f4c9.js";import{c as B,d as J,a as K}from"./dialog-polyfill.esm.c4f433fc.js";const Q={class:"tw-card bg-[#424242] p-4 w-4/5"},W=["d"],X={class:"flex flex-col"},Y={class:"m-0 p-4"},Z={key:0},ee={for:"range-1"},te={key:1},ne={class:"h-6",for:"range-1"},oe={for:"range-1"},se=e("option",{value:"sawtooth"},"Sawtooth",-1),le=e("option",{selected:"",value:"sine"},"Sine",-1),ae=e("option",{value:"square"},"Square",-1),ie=e("option",{value:"triangle"},"Triangle",-1),re=[se,le,ae,ie],ce={class:"flex justify-center"},ue=C("Stop"),de=C("Start"),fe=V({props:{generator:null},emits:["deleteGenerator"],setup(T){const d=T,i=v(.07),o=v(440),c=v("sine"),_=v(""),h=v(4),p=v(0),l=v(!1);let n,t,u,g=!1,x=0,m=9;const M=2**(1/12),S=440,A=["C","D\u266D","D","E\u266D","E","F","G\u266D","G","A\u266D","A","B\u266D","B"];d.generator.generatorType==="Frequency"?q(o,()=>{g||w(),t.frequency.setValueAtTime(o.value,n.currentTime)}):q(p,(y,s)=>{g||w(),x=y-s,U(),x>0?D("Up"):(x=Math.abs(x),D("Down"))}),q(i,()=>{g||w(),l.value?(t.disconnect(),u.gain.setValueAtTime(i.value,n.currentTime),t.connect(u).connect(n.destination)):u.gain.setValueAtTime(i.value,n.currentTime)}),q(c,()=>{g||w(),l.value?(t.disconnect(),t.type=c.value,t.connect(u).connect(n.destination)):t.type=c.value}),E(()=>{t==null||t.disconnect()});function G(){l.value=!l.value,g||w(),l.value?t.connect(u).connect(n.destination):t.disconnect()}function j(y){return parseFloat((y*2*100).toFixed(1))}function w(){n=new AudioContext,u=new GainNode(n,{gain:i.value}),t=new OscillatorNode(n,{type:c.value,frequency:o.value}),t.start(),t.connect(n.destination),t.disconnect(),g=!0}function D(y){do y==="Up"?m===11?(h.value++,m=0):m++:m===0?(h.value--,m=11):m--,_.value=A[m],x--;while(x>0)}function U(){o.value=parseFloat((S*M**p.value).toFixed(4)),t.frequency.setValueAtTime(o.value,n.currentTime)}return(y,s)=>(a(),r("div",Q,[(a(),r("svg",{class:"h-6 float-right cursor-pointer",viewBox:"0 0 24 24",onClick:s[0]||(s[0]=f=>y.$emit("deleteGenerator"))},[e("path",{fill:"currentColor",d:b(B)},null,8,W)])),e("div",X,[e("div",Y,[T.generator.generatorType==="Frequency"?(a(),r("div",Z,[e("label",ee," Frequency: "+k(o.value),1),F(e("input",{id:"range-1","onUpdate:modelValue":s[1]||(s[1]=f=>o.value=f),class:"w-full h-6 bg-transparent",type:"range",min:"10",max:"22000",step:"10"},null,512),[[$,o.value]])])):T.generator.generatorType==="Note"?(a(),r("div",te,[e("label",ne,[C(" Note/ Frequency: "+k(_.value)+" ",1),e("sub",null,k(h.value),1),C(" / "+k(o.value),1)]),F(e("input",{id:"range-1","onUpdate:modelValue":s[2]||(s[2]=f=>p.value=f),class:"w-full h-6 bg-transparent",type:"range",min:"-57",max:"68",step:"1"},null,512),[[$,p.value]])])):z("",!0),e("div",null,[e("label",oe," Volume: "+k(j(i.value))+"% ",1),F(e("input",{id:"range-1","onUpdate:modelValue":s[3]||(s[3]=f=>i.value=f),class:"w-full h-6 bg-transparent",type:"range",min:"0",max:"1",step:"0.0005"},null,512),[[$,i.value]])]),F(e("select",{"onUpdate:modelValue":s[4]||(s[4]=f=>O(c)?c.value=f:null),class:"pt-2 pr-9 pb-2 pl-3 text-black border border-solid border-[#ced4da] rounded my-0 mx-auto flex justify-center"},re,512),[[L,b(c)]])]),e("div",ce,[e("button",{class:"tw-button",onClick:G},[l.value?(a(),r(N,{key:0},[ue],64)):(a(),r(N,{key:1},[de],64))])])])]))}}),ve={class:"flex flex-col justify-center items-center"},pe=e("h1",{class:"m-4 mb-0 text-2xl font-semibold"},"Frequency Generator",-1),ge={class:"flex justify-center"},me=["d"],ye={id:"generatorModal",class:"text-gray-300 bg-[#383838] w-72"},_e={class:"flex justify-between p-4 border-b border-solid border-[#dee2e6]"},he=e("h5",null,"Add a new generator",-1),xe=["d"],be={class:"p-4 flex gap-2 justify-center"},Te=V({setup(T){const d=P([{id:0,generatorType:"Frequency"},{id:1,generatorType:"Note"}]);let i;const o=v();R(()=>{J.registerDialog(o.value),i=document.querySelector("#generatorModal")});function c(){o.value.showModal(),setTimeout(()=>{document.addEventListener("click",h)},0)}function _(){document.removeEventListener("click",h),o.value.close()}function h(l){l.composedPath().includes(i)||_()}function p(l){d.push({id:d.length>0?d[d.length-1].id+1:0,generatorType:l}),_()}return(l,n)=>(a(),r(N,null,[e("div",ve,[pe,(a(!0),r(N,null,H(b(d),(t,u)=>(a(),I(fe,{key:t.id,index:u,generator:t,onDeleteGenerator:g=>b(d).splice(u,1)},null,8,["index","generator","onDeleteGenerator"]))),128)),e("div",ge,[(a(),r("svg",{class:"w-[50px] cursor-pointer tw-button fill-white bg-zinc-500 mt-4 rounded-xl p-[2px]",viewBox:"0 0 20 20",onClick:c},[e("path",{d:b(K)},null,8,me)]))])]),e("dialog",{ref_key:"generatorModal",ref:o,class:"bg-transparent"},[e("div",ye,[e("div",_e,[he,(a(),r("svg",{class:"h-6 cursor-pointer",viewBox:"0 0 24 24",onClick:_},[e("path",{fill:"currentColor",d:b(B)},null,8,xe)]))]),e("div",be,[e("button",{class:"tw-button",onClick:n[0]||(n[0]=t=>p("Frequency"))}," Frequency "),e("button",{class:"tw-button",onClick:n[1]||(n[1]=t=>p("Note"))},"Note")])])],512)],64))}});export{Te as default};
