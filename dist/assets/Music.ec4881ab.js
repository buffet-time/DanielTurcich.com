import{d as L,r as p,o as U,b as n,e as h,f as t,t as v,u as r,l as N,F as A,y as E,z as H,x as Q,w as Y,A as F,m as P,g as B,n as Z,B as z,q as V,p as G,h as K,C as I}from"./vendor.0d73fd90.js";import{d as R,c as ee}from"./dialog-polyfill.esm.c4f433fc.js";import{_ as W}from"./index.58e3d183.js";var s=(e=>(e[e.artist=0]="artist",e[e.name=1]="name",e[e.score=2]="score",e[e.type=3]="type",e[e.year=4]="year",e[e.genre=5]="genre",e[e.comments=6]="comments",e))(s||{}),T=(e=>(e[e["1950s"]=0]="1950s",e[e["1960s"]=1]="1960s",e[e["1970s"]=2]="1970s",e[e["1980s"]=3]="1980s",e[e["1990s"]=4]="1990s",e[e["2000s"]=5]="2000s",e[e["2010s"]=6]="2010s",e[e["2020s"]=7]="2020s",e))(T||{});const te={class:"tw-card m-0 p-2 h-full bg-transparent flex flex-col items-center justify-center"},se={class:"overflow-hidden text-ellipsis max-w-full whitespace-nowrap"},ae={class:"overflow-hidden text-ellipsis max-w-full whitespace-nowrap"},re={id:"releaseModal",class:"text-neutral-300 bg-[#383838] w-96"},le={class:"flex items-center justify-between p-4 border-b border-solid border-[#dee2e6]"},oe={class:"whitespace-nowrap"},ne=["d"],ie={class:"flex flex-col items-center justify-center p-4 border-b border-solid border-[#dee2e6]"},ue={class:"mb-4"},ce=N("No comments for this release."),de={class:"flex justify-between p-4 items-center"},ve=L({props:{index:null,release:null},setup(e){const f=e;let x;const c=p();U(()=>{R.registerDialog(c.value),x=document.querySelector("#releaseModal")});function b(){navigator.clipboard.writeText(` ${f.release[s.artist]} - ${f.release[s.name]}: ${f.release[s.score]}`)}function w(){c.value.showModal(),setTimeout(()=>{document.addEventListener("click",i)},0)}function y(){document.removeEventListener("click",i),c.value.close()}function i(_){_.composedPath().includes(x)||y()}return(_,g)=>(n(),h(A,null,[t("div",{class:"tw-card bg-neutral-500 text-center m-2 cursor-pointer w-80 h-24 rounded",onClick:w},[t("div",te,[t("h5",se,v(e.release[r(s).artist]),1),t("h6",ae,v(e.release[r(s).name])+" ("+v(e.release[r(s).score])+"/10) ",1)])]),t("dialog",{ref_key:"releaseModal",ref:c,class:"bg-transparent"},[t("div",re,[t("div",le,[t("h5",null,[N(v(e.release[r(s).artist])+" - "+v(e.release[r(s).name])+" ",1),t("span",oe," ( "+v(e.release[r(s).score])+"/10 ) ",1)]),(n(),h("svg",{class:"w-6 min-w-[24px] cursor-pointer",viewBox:"0 0 24 24",onClick:y},[t("path",{fill:"currentColor",d:r(ee)},null,8,ne)]))]),t("div",ie,[t("div",ue,"Genres: "+v(e.release[r(s).genre]),1),e.release.length===7?(n(),h(A,{key:0},[N(v(e.release[r(s).comments]),1)],64)):(n(),h(A,{key:1},[ce],64))]),t("div",de,[N(" ("+v(e.release[r(s).year])+" "+v(e.release[r(s).type])+") ",1),t("div",null,[t("button",{class:"tw-button mr-2",onClick:b},"Copy"),t("button",{type:"button",class:"tw-button",onClick:y}," Close ")])])])],512)],64))}});const he=e=>(G("data-v-787454f4"),e=e(),K(),e),me={id:"searchContent",class:"w-full"},fe=he(()=>t("h3",{class:"mb-2"},"Search by:",-1)),ye=["value"],pe=["value"],be=["value"],_e=["value"],we=["value"],ge=["value"],ke={class:"m-4 flex justify-center"},xe={key:0,class:"flex flex-col"},Se={class:"mb-1"},$e={key:1},Ae=["value"],Ce={key:2,class:"flex flex-col"},Ye={for:"customRange1",class:"form-label"},qe=["placeholder","min","max"],Me=["onKeyup"],je=["disabled"],Ne={key:0,ref:"releases",class:"m-2 mt-4 mb-2 flex flex-wrap justify-center"},Te={key:1},Le=L({props:{currentYear:null,earliestYear:null,releasesArray:null,initializing:{type:Boolean}},setup(e){const f=e,x=E(),c=H();let b=!0;const w=f.currentYear,y=p([[""]]),i=p(s.artist),_=p(!1),g=p(!1),a=p(""),C=["Album","EP","Live Album","Soundtrack","Remix Album","Compilation","Demo Album"];Q(i,()=>{if(!(b&&c.query.term))switch(x.replace({query:{tab:"Search",term:a.value,type:s[i.value]}}),i.value){case s.score:a.value="7";break;case s.type:a.value="Album";break;case s.year:a.value=String(w);break;default:a.value=""}}),U(()=>{if(c.query.term){a.value=c.query.term,i.value=s[c.query.type];const u=setInterval(()=>{f.initializing||(S(),clearInterval(u),b=!1)},250)}else c.query.type&&(i.value=s[c.query.type]);window.addEventListener("keydown",u=>{if(u.key==="ArrowLeft"||u.key==="ArrowRight")switch(i.value){case s.score:M(u.key,.5,0,10);break;case s.year:M(u.key,1,f.earliestYear,w);break}})});function M(u,m,l,k){u==="ArrowLeft"&&Number(a.value)>l?a.value=String(a.value+-m):u==="ArrowRight"&&Number(a.value)<k&&(a.value=String(a.value+m))}function S(){_.value=!1,g.value=!1,a.value=a.value.trim();let u=!1;switch(i.value){case s.score:u=!0;break;case s.type:u=!0;break;case s.year:u=!0;break}y.value=j(i.value,u),y.value.length>0?_.value=!0:g.value=!0,x.replace({query:{tab:"Search",term:a.value,type:s[i.value]}})}function j(u,m){return f.releasesArray.filter(l=>m?l[u].toLowerCase()===a.value.toLowerCase():l[u].toLowerCase().includes(a.value.toLowerCase()))}return(u,m)=>(n(),h("div",me,[fe,Y(t("select",{"onUpdate:modelValue":m[0]||(m[0]=l=>i.value=l),class:"text-black pl-4 py-2 rounded w-72"},[t("option",{selected:"",value:r(s).artist},"Artist",8,ye),t("option",{value:r(s).name},"Release Name",8,pe),t("option",{value:r(s).score},"Score",8,be),t("option",{value:r(s).type},"Type",8,_e),t("option",{value:r(s).year},"Year",8,we),t("option",{value:r(s).genre},"Genre",8,ge)],512),[[F,i.value]]),t("div",ke,[i.value===r(s).score?(n(),h("div",xe,[t("div",Se,v(a.value),1),Y(t("input",{"onUpdate:modelValue":m[1]||(m[1]=l=>a.value=l),placeholder:"10",type:"range",class:"w-64 bg-transparent h-2",min:"0",max:"10",step:"0.5"},null,512),[[P,a.value]])])):i.value===r(s).type?(n(),h("div",$e,[Y(t("select",{"onUpdate:modelValue":m[2]||(m[2]=l=>a.value=l),class:"text-black pl-4 py-2 rounded w-64"},[(n(),h(A,null,B(C,(l,k)=>t("option",{key:k,value:l},v(l),9,Ae)),64))],512),[[F,a.value]])])):i.value===r(s).year?(n(),h("div",Ce,[t("label",Ye,v(a.value),1),Y(t("input",{"onUpdate:modelValue":m[3]||(m[3]=l=>a.value=l),placeholder:String(r(w)),type:"range",class:"w-64 bg-transparent h-2",min:e.earliestYear,max:r(w),step:"1"},null,8,qe),[[P,a.value]])])):Y((n(),h("input",{key:3,"onUpdate:modelValue":m[4]||(m[4]=l=>a.value=l),class:"w-64 py-2 px-3 text-black rounded",placeholder:"Search input",onKeyup:Z(S,["enter"])},null,40,Me)),[[P,a.value]]),t("button",{disabled:e.initializing||a.value.length<1,class:"ml-4 tw-button",onClick:S}," Search ",8,je)]),_.value?(n(),h("div",Ne,[(n(!0),h(A,null,B(y.value,(l,k)=>(n(),z(ve,{key:k,index:k,release:l},null,8,["index","release"]))),128))],512)):V("",!0),g.value?(n(),h("div",Te,"No results from your search.")):V("",!0)]))}}),Oe=W(Le,[["__scopeId","data-v-787454f4"]]);const q=e=>(G("data-v-5ad3b9c3"),e=e(),K(),e),Pe={id:"statsContent",class:"w-full flex justify-center"},Be={class:"table-auto text-white w-96 border-collapse bg-[#212529]"},ze=q(()=>t("thead",{class:"border-solid p-2"},[t("tr",null,[t("th",null,"Stat"),t("th",null,"Value")])],-1)),Ve=q(()=>t("th",null,"Number of releases",-1)),De=q(()=>t("th",null,"Number of artists",-1)),Fe=q(()=>t("th",null,"Average Year",-1)),Ue=q(()=>t("th",null,"Average Score",-1)),Ee={key:0},He={key:1},Ge=L({props:{statsObject:null},setup(e){return(f,x)=>(n(),h("div",Pe,[t("table",Be,[ze,t("tbody",null,[t("tr",null,[Ve,t("td",null,v(e.statsObject.numberOfReleases),1)]),t("tr",null,[De,t("td",null,v(e.statsObject.numberOfArtists),1)]),t("tr",null,[Fe,t("td",null,v(e.statsObject.averageYear),1)]),t("tr",null,[Ue,t("td",null,v(e.statsObject.averageScore),1)]),(n(!0),h(A,null,B(e.statsObject.releasesPerYear,(c,b)=>(n(),h("tr",{key:b},[b>0?(n(),h("th",Ee," Releases in the "+v(`${1950+b*10}s`),1)):(n(),h("th",He,"Releases before 1960")),t("td",null,v(c),1)]))),128))])])]))}}),Ke=W(Ge,[["__scopeId","data-v-5ad3b9c3"]]),We={class:"tw-flex-col-center gap-4"},Xe=t("h1",{class:"mt-4 text-2xl font-semibold"},"My Music Page",-1),Ie=L({setup(e){const f="loading...",c=[],b=E(),w=H();for(let o=0;o<T["2020s"]+1;o++)c.push(0);const y=p("Stats"),i=p([[""]]),_=p(!0),g=p(2021),a=p({numberOfReleases:f,averageYear:f,averageScore:f,numberOfArtists:f,releasesPerYear:c}),C=[],M=[{id:"1tn0BmleHcs0okzWKhUnyOCWUPD422HvutpNQNzdAAIk",range:"Main!A2:F"},{id:"1dmETb3Ybqs8Dhez_kP2DHiXR_Gqw-X56qsXDHYyTH1w",range:"Main!A2:F"},{id:"18V5oypFBW3Bu_tHxfTL-iSbb9ALYrCJlMwLhpPmp72M",range:"Main!A2:G"},{id:"1lyFD7uLMT0mRdGkKwvbIm_2pqk2YJU7rtRQVhHq-nwU",range:"Main!A2:G"}];let S=0,j=0,u=0,m=0,l=0;I(async()=>{const o=w.query.tab;o==="Search"?D(o):O("Stats"),await k(),_.value=!1,i.value.forEach(d=>{C.includes(d[s.artist])||C.push(d[s.artist]);const $=Number(d[s.year]);$<g.value&&(g.value=$),l+=$,u++,J(d[s.score])?(m+=Number(d[s.score]),S++):d[s.score]=="?"&&j++,$>1959?c[T[d[s.year].slice(0,3)+"0s"]]++:c[T["1950s"]]++}),a.value={averageScore:(m/S).toFixed(2),numberOfArtists:C.length,averageYear:(l/u).toFixed(2),numberOfReleases:S+j,releasesPerYear:c}});async function k(){i.value=(await Promise.all(M.map(o=>X(o.id,o.range)))).flat().filter(o=>(o.forEach(d=>{d.trim()}),o.length>5))}async function X(o,d){return(await fetch(`https://api.danielturcich.com/Sheets?id=${o}&range=${d}`)).json()}function J(o){return!isNaN(Number(o))}function D(o){y.value=o}function O(o){const d={query:{tab:o}};o==="Search"&&(d.query.type="artist"),b.replace(d),D(o)}return(o,d)=>(n(),h("div",We,[Xe,t("div",null,[t("button",{class:"tw-tab-button",type:"button",onClick:d[0]||(d[0]=$=>O("Stats"))}," Stats "),t("button",{class:"tw-tab-button",type:"button",onClick:d[1]||(d[1]=$=>O("Search"))}," Search ")]),r(y)==="Stats"?(n(),z(Ke,{key:0,"stats-object":r(a)},null,8,["stats-object"])):r(y)==="Search"?(n(),z(Oe,{key:1,"current-year":2021,"earliest-year":g.value,"releases-array":i.value,initializing:_.value},null,8,["earliest-year","releases-array","initializing"])):V("",!0)]))}});export{Ie as default};
